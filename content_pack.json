{"name":"HAProxy Content Pack for Graylog","description":"HAProxy Content Pack for Graylog - one click setup!\\n\\nA Content Pack for Graylog2 which supports HTTP Real-Time logging and Monitoring from HAProxy.\\n\\nMarketplace: https://marketplace.graylog.org/addons/4ace8af0-6ff3-4409-87e1-bd543bc8794c\\n\\nGithub: https://github.com/hariom282538/graylog-content-pack-haproxy-json\\n\\nAuthor: Hariom Vashisth","category":"web","inputs":[{"id":"5b488ff66178890566085886","title":"HaProxy log","configuration":{"expand_structured_data":true,"recv_buffer_size":262144,"port":12211,"override_source":null,"force_rdns":false,"allow_override_date":true,"bind_address":"0.0.0.0","store_full_message":false},"static_fields":{"from_haproxy":"true"},"type":"org.graylog2.inputs.syslog.udp.SyslogUDPInput","global":true,"extractors":[{"title":"Empty JSON field","type":"REGEX_REPLACE","cursor_strategy":"COPY","target_field":"message","source_field":"message","configuration":{"replacement":"-","regex":".*"},"converters":[],"condition_type":"NONE","condition_value":"","order":1},{"title":"Reduced message to path","type":"REGEX_REPLACE","cursor_strategy":"COPY","target_field":"message","source_field":"message","configuration":{"replacement":"$1","regex":".*request\": \"(.*?)\".*"},"converters":[],"condition_type":"NONE","condition_value":"","order":2},{"title":"Extract JSON fields","type":"JSON","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"flatten":true,"list_separator":", ","kv_separator":"=","key_prefix":"","key_separator":"_","replace_key_whitespace":false,"key_whitespace_replacement":"_"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"HTTP URI from haproxy_httpRequest ","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_httpRequestURI","source_field":"haproxy_httpRequest","configuration":{"index":2,"split_by":" "},"converters":[],"condition_type":"NONE","condition_value":"","order":4},{"title":"HTTP Method from haproxy_httpRequest ","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_httpRequestMethod","source_field":"haproxy_httpRequest","configuration":{"index":1,"split_by":" "},"converters":[],"condition_type":"NONE","condition_value":"","order":3},{"title":"Empty haproxy_httpRequest Field","type":"REGEX_REPLACE","cursor_strategy":"COPY","target_field":"haproxy_httpRequest","source_field":"haproxy_httpRequest","configuration":{"replacement":"-","regex":".*"},"converters":[],"condition_type":"NONE","condition_value":"","order":6},{"title":"HTTP Request Protocol version from haproxy_httpRequest ","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_httpRequestProtocolVersion","source_field":"haproxy_httpRequest","configuration":{"index":3,"split_by":" "},"converters":[],"condition_type":"NONE","condition_value":"","order":5},{"title":"Host Extraction from Captured HTTP Request","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_capturedHttpRequestHost","source_field":"haproxy_capturedRequestHeaders","configuration":{"index":1,"split_by":"|"},"converters":[],"condition_type":"NONE","condition_value":"","order":8},{"title":"Removing parenthesis from haproxy_capturedRequestHeaders","type":"REGEX_REPLACE","cursor_strategy":"COPY","target_field":"haproxy_capturedRequestHeaders","source_field":"haproxy_capturedRequestHeaders","configuration":{"regex":"[{}]","replacement":" ","replace_all":true},"converters":[],"condition_type":"NONE","condition_value":"","order":7},{"title":"User Agent Extraction from Captured HTTP Request ","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_capturedHttpRequestUserAgent","source_field":"haproxy_capturedRequestHeaders","configuration":{"index":2,"split_by":"|"},"converters":[],"condition_type":"NONE","condition_value":"","order":9},{"title":"HTTP Referer Extraction from Captured HTTP Request","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_capturedHttpRequestReferer","source_field":"haproxy_capturedRequestHeaders","configuration":{"index":3,"split_by":"|"},"converters":[],"condition_type":"NONE","condition_value":"","order":10},{"title":"HTTP XForwardedFor Extraction from Captured HTTP Request ","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_capturedHttpRequestXForwardedFor","source_field":"haproxy_capturedRequestHeaders","configuration":{"index":4,"split_by":"|"},"converters":[],"condition_type":"NONE","condition_value":"","order":11},{"title":"Browser Extraction from haproxy_capturedHttpRequestUserAgent","type":"SPLIT_AND_INDEX","cursor_strategy":"COPY","target_field":"haproxy_capturedHttpRequestBrowser","source_field":"haproxy_capturedHttpRequestUserAgent","configuration":{"index":1,"split_by":" "},"converters":[],"condition_type":"NONE","condition_value":"","order":12}]}],"streams":[{"id":"5b4ca7e19069e6058126b012","title":"haproxy","description":"All requests that were logged into the haproxy log","disabled":false,"matching_type":"AND","stream_rules":[{"type":"EXACT","field":"from_haproxy","value":"true","inverted":false,"description":""},{"type":"EXACT","field":"application_name","value":"haproxy","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5b4d74bcb94b5308d33801b1","title":"haproxy HTTP 4XXs","description":"All requests that were answered with a HTTP code in the 400 range by haproxy","disabled":false,"matching_type":"AND","stream_rules":[{"type":"GREATER","field":"haproxy_statusCode","value":"399","inverted":false,"description":""},{"type":"SMALLER","field":"haproxy_statusCode","value":"500","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5b4d74d5b94b5308d33801ce","title":"haproxy HTTP 5XXs","description":"All requests that were answered with a HTTP code in the 500 range by haproxy","disabled":false,"matching_type":"AND","stream_rules":[{"type":"GREATER","field":"haproxy_statusCode","value":"499","inverted":false,"description":""},{"type":"SMALLER","field":"haproxy_statusCode","value":"600","inverted":false,"description":""}],"outputs":[],"default_stream":false}],"outputs":[],"dashboards":[{"title":"Centralized HTTP Monitoring ","description":"All requests that were logged into the organisation system.","dashboard_widgets":[{"description":"Top 5 countries with Most Requests last 24h","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_capturedHttpRequestXForwardedFor_country_code","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":5},"col":1,"row":4,"height":2,"width":1},{"description":"Top 10 Browsers with most requests : 24h","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_capturedHttpRequestBrowser","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":10,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":10},"col":2,"row":16,"height":3,"width":2},{"description":"HTTP 4XXs last 24h","type":"SEARCH_RESULT_CHART","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"interval":"hour","stream_id":"5b4d74bcb94b5308d33801b1","query":""},"col":2,"row":2,"height":1,"width":2},{"description":"HTTP 5XXs last 24h","type":"SEARCH_RESULT_CHART","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"interval":"hour","stream_id":"5b4d74d5b94b5308d33801ce","query":""},"col":2,"row":3,"height":1,"width":2},{"description":"Requests last 24h","type":"STREAM_SEARCH_RESULT_COUNT","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"lower_is_better":false,"stream_id":"5b4ca7e19069e6058126b012","trend":true,"query":""},"col":1,"row":1,"height":1,"width":1},{"description":"Requests last 24h","type":"SEARCH_RESULT_CHART","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"interval":"hour","stream_id":"5b4ca7e19069e6058126b012","query":""},"col":2,"row":1,"height":1,"width":2},{"description":"HTTP 4XXs last 24h","type":"STREAM_SEARCH_RESULT_COUNT","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"lower_is_better":true,"stream_id":"5b4d74bcb94b5308d33801b1","trend":true,"query":""},"col":1,"row":2,"height":1,"width":1},{"description":"HTTP 5XXs last 24h","type":"STREAM_SEARCH_RESULT_COUNT","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"lower_is_better":true,"stream_id":"5b4d74d5b94b5308d33801ce","trend":true,"query":""},"col":1,"row":3,"height":1,"width":1},{"description":"Frontend Connection Graph: Last 7 days","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"mean","renderer":"line","interpolation":"linear","timerange":{"type":"relative","range":604800},"rangeType":"relative","field":"haproxy_FrontendCurrentConn","stream_id":"5b4ca7e19069e6058126b012","query":"","interval":"hour","relative":604800},"col":1,"row":19,"height":1,"width":3},{"description":"Average Request Time (in ms) last 24 h","type":"STATS_COUNT","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_Tt","stream_id":"5b4ca7e19069e6058126b012","trend":true,"query":"_exists_:haproxy_statusCode AND _exists_:haproxy_Tt AND haproxy_statusCode:200","stats_function":"mean","lower_is_better":true},"col":1,"row":6,"height":1,"width":1},{"description":"Average Request Size (in bytes) last 24 h","type":"STATS_COUNT","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_bytesRead","stream_id":"5b4ca7e19069e6058126b012","trend":true,"query":"_exists_:haproxy_statusCode AND _exists_:haproxy_Tt AND haproxy_statusCode:200","stats_function":"mean","lower_is_better":true},"col":1,"row":7,"height":1,"width":1},{"description":"Response size (bytes) last 24h","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"mean","renderer":"line","interpolation":"linear","timerange":{"type":"relative","range":86400},"rangeType":"relative","field":"haproxy_bytesRead","stream_id":"5b4ca7e19069e6058126b012","query":"_exists_:haproxy_statusCode AND _exists_:haproxy_Tt AND haproxy_statusCode:200","interval":"minute","relative":28800},"col":2,"row":7,"height":1,"width":2},{"description":"Response Time (ms) last 24h","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"mean","renderer":"line","interpolation":"linear","timerange":{"type":"relative","range":86400},"rangeType":"relative","field":"haproxy_Tt","stream_id":"5b4ca7e19069e6058126b012","query":"_exists_:haproxy_statusCode AND _exists_:haproxy_Tt AND haproxy_statusCode:200","interval":"minute","relative":28800},"col":2,"row":6,"height":1,"width":2},{"description":"Time/Size last 24h","type":"STACKED_CHART","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"renderer":"line","interpolation":"linear","stream_id":"5b4ca7e19069e6058126b012","series":[{"query":"_exists_:haproxy_statusCode AND _exists_:haproxy_Tt AND haproxy_statusCode:200","field":"haproxy_bytesRead","statistical_function":"mean"},{"query":"_exists_:haproxy_statusCode AND _exists_:haproxy_Tt AND haproxy_statusCode:200","field":"haproxy_Tt","statistical_function":"mean"}],"interval":"minute"},"col":1,"row":8,"height":2,"width":3},{"description":"Top 10 IPs with Most Requests last 24h","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_capturedHttpRequestXForwardedFor","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":10,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":10},"col":3,"row":13,"height":3,"width":1},{"description":"Top 10 Most Requested Domains : 24h ","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_capturedHttpRequestHost","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":10,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":10},"col":3,"row":10,"height":3,"width":1},{"description":"Response codes last 24h","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_statusCode","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":15,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":15},"col":2,"row":10,"height":3,"width":1},{"description":"Requests per HTTP Methods: last 24h","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_httpRequestMethod","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":10,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":10},"col":1,"row":10,"height":3,"width":1},{"description":"Map of requests last 24h","type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_capturedHttpRequestXForwardedFor_geolocation","stream_id":"5b4ca7e19069e6058126b012","query":""},"col":2,"row":4,"height":2,"width":2},{"description":"Top 10 URLs with most requests : last 24h","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"haproxy_capturedHttpRequestHost","stream_id":"5b4ca7e19069e6058126b012","query":"","show_data_table":true,"limit":10,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"haproxy_httpRequestURI","data_table_limit":10},"col":1,"row":13,"height":3,"width":2},{"description":"Top Hourly backends","type":"QUICKVALUES","cache_time":300,"configuration":{"timerange":{"type":"keyword","keyword":"Last Hour"},"field":"haproxy_backend","query":"application_name:haproxy","show_data_table":true,"limit":20,"show_pie_chart":true,"data_table_limit":20},"col":1,"row":16,"height":3,"width":1}]}],"grok_patterns":[],"lookup_tables":[],"lookup_caches":[],"lookup_data_adapters":[]}